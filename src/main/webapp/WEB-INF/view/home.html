<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø–æ–≥–æ–¥—ã</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        header.bg-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #6366f1 100%);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            border-radius: 0 0 16px 16px;
        }

        /* —Ñ–∏–∫—Å–∏—Ä—É–µ–º —à–∏—Ä–∏–Ω—É —ç–ª–µ–º–µ–Ω—Ç–æ–≤, —á—Ç–æ–±—ã –æ–Ω–∏ –±—ã–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ */
        .search-form .form-control,
        .search-form .form-select {
            width: 230px;   /* –º–æ–∂–Ω–æ –ø–æ–¥–æ–±—Ä–∞—Ç—å –ø–æ–¥ —Å–µ–±—è */
        }

        /* –∫–Ω–æ–ø–∫–∏ –±–µ–∑ –ø–µ—Ä–µ–Ω–æ—Å–∞ —Ç–µ–∫—Å—Ç–∞ */
        .search-form .btn {
            white-space: nowrap;
        }


        .form-control, .form-select {
            border-radius: 0.5rem;
            border: none;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        .btn-light {
            border-radius: 0.5rem;
            font-weight: 500;
        }

        .btn-light:hover {
            background-color: #f0f0f0;
        }

        .btn-danger {
            border-radius: 0.5rem;
            padding: 0.375rem 1.25rem;
            font-weight: 500;
        }

        .card {
            border-radius: 1rem;
            backdrop-filter: blur(8px);
            background: rgba(255, 255, 255, 0.9);
            animation: fadeIn 0.8s ease-in;
        }

        .card-footer button {
            border-radius: 0;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h3 {
            font-weight: 600;
        }

        @media (max-width: 768px) {
            header .row > div {
                margin-bottom: 1rem;
            }
        }
    </style>
</head>
<body>

<!-- –®–∞–ø–∫–∞ -->
<header class="bg-primary text-white p-3">
    <div class="container">
        <div class="row align-items-center">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
            <div class="col-lg-3 col-md-12">
                <h3 class="mb-0">–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø–æ–≥–æ–¥—ã</h3>
            </div>

            <!-- –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ -->
            <!-- –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞: –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ –æ–¥–Ω—É –ª–∏–Ω–∏—é -->
            <div class="col-lg-6 col-md-12 d-flex justify-content-center">
                <form th:action="@{/search_location}" method="post"
                      class="d-flex flex-nowrap align-items-center gap-2 search-form w-100 justify-content-center">

                    <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ -->
                    <input type="text" name="cityName" class="form-control"
                           placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Å—Ç–∞" required>

                    <!-- –°–µ–ª–µ–∫—Ç -->
                    <select name="source" class="form-select">
                        <option value="WeatherRepository">OpenWeather</option>
                        <option value="WeatherAPIRepository">WeatherAPI</option>
                    </select>

                    <!-- –ö–Ω–æ–ø–∫–∏ -->
                    <button type="submit" class="btn btn-light">–ù–∞–π—Ç–∏</button>

                    <!-- –ö–Ω–æ–ø–∫–∞ 'API'  ‚îÄ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º HTML-–≤–∞–ª–∏–¥–∞—Ü–∏—é -->
                    <button type="submit"
                            th:formaction="@{/change_api}"
                            formmethod="post"
                            formnovalidate
                            class="btn btn-outline-light d-flex align-items-center">
                        <i class="bi bi-arrow-repeat me-1"></i> API
                    </button>


                </form>
            </div>



            <!-- –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è + –≤—ã—Ö–æ–¥ -->
            <div class="col-lg-3 col-md-12 d-flex justify-content-lg-end justify-content-center align-items-center mt-3 mt-lg-0">
                <span th:if="${login}" class="me-2">
                    –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <strong th:text="${login}">–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</strong>
                </span>
                <a href="/logout" class="btn btn-danger">–í—ã–π—Ç–∏</a>
            </div>
        </div>
    </div>
</header>

<!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
<main class="container mt-5">
    <div class="row" th:if="${weathers != null && weathers.size() > 0}">
        <div class="col-md-4 mb-4" th:each="weather : ${weathers}">
            <div class="card shadow-sm text-center p-4">
                <img th:src="${weather.weatherDetails[0].icon}" alt="Weather icon" style="width: 80px;" class="mb-3" />
                <h5 th:text="${weather.name}">–ì–æ—Ä–æ–¥</h5>
                <p>üå° –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: <span th:text="${weather.parameters.temp} + ' ¬∞C'"></span></p>
                <p>üíß –í–ª–∞–∂–Ω–æ—Å—Ç—å: <span th:text="${weather.parameters.humidity} + '%'"></span></p>
                <p>üå¨ –°–∫–æ—Ä–æ—Å—Ç—å –≤–µ—Ç—Ä–∞: <span th:text="${weather.wind.speed} + ' –º/—Å'"></span></p>
                <p>üå§ –°–æ—Å—Ç–æ—è–Ω–∏–µ: <span th:text="${weather.weatherDetails[0].main}"></span></p>
                <p>üìù –û–ø–∏—Å–∞–Ω–∏–µ: <span th:text="${weather.weatherDetails[0].description}"></span></p>

                <form th:action="@{/delete_location}" method="post" class="mt-3">
                    <input type="hidden" name="name" th:value="${weather.name}" />
                    <input type="hidden" name="lat" th:value="${weather.coordinates.lat}" />
                    <input type="hidden" name="lon" th:value="${weather.coordinates.lon}" />
                    <button type="submit" class="btn btn-outline-danger w-100">–£–¥–∞–ª–∏—Ç—å</button>
                </form>
            </div>
        </div>
    </div>

    <p th:if="${weathers == null || weathers.size() == 0}" class="text-white text-center fs-4">
        –ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.
    </p>
</main>

</body>
</html>
